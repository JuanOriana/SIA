from TP5.data_structs.Layer import Layer, NeuralNetwork
from TP5.perceptron_funcs.activations import *
from TP5.resources.fonts import get_parsed_fonts
from TP5.utils.plotting_scripts import plot_latent_space_2D_static, plot_latent_space_2D


def demo():
    layer1 = Layer(5, 35)
    layer2 = Layer(2, 5)
    layer3 = Layer(5, 2)
    layer4 = Layer(35, 5)

    inputs = get_parsed_fonts()

    # Combine the layers to create a neural network
    neural_network = NeuralNetwork([layer1, layer2, layer3, layer4], sigmoid_classic_activation,
                                   sigmoid_classic_activation_derivative, 0.1)
    encoder = NeuralNetwork([layer1, layer2], sigmoid_classic_activation, sigmoid_classic_activation_derivative, 0.1)
    decoder = NeuralNetwork([layer3, layer4], sigmoid_classic_activation, sigmoid_classic_activation_derivative, 0.1)

    arr = [1.49004909e+00, -1.29997562e+00, - 7.32329950e-01, -1.87350811e+00
        , -2.58929517e-01, 4.17531048e-01, -1.09970634e+00, -3.96236830e-01
        , -9.48132428e-01, -1.75880342e-01, 1.83290149e+00, -5.48122918e-02
        , -1.26298885e+00, 9.63212720e-01, -2.38288370e+00, 2.37852096e+00
        , -1.90106148e-01, -7.22512173e-01, -1.02443790e+00, -4.77235794e-01
        , 4.30737418e-01, -2.67802258e-01, -8.49618039e-01, -3.10249789e+00
        , 5.54082094e-01, 3.42697729e-01, -1.37810919e+00, -1.84030002e+00
        , 4.67248988e-01, -1.89378580e+00, 4.70642925e-01, 2.13819238e+00
        , -2.25346246e-01, 7.70809221e-01, 1.43300454e+00, 1.89654176e+00
        , 2.20760000e+00, -1.37114937e-02, -3.40710577e+00, 1.83910195e+00
        , 1.18073491e+00, 2.51370590e+00, 1.61086138e+00, 5.13475493e-01
        , -8.74165781e-01, 1.16232942e-01, -4.04839469e-02, -1.22482747e+00
        , -4.08777843e-01, -1.61659076e+00, -1.00769219e+00, 1.94432477e-01
        , -5.70971574e-02, 1.52166677e+00, -9.07424160e-01, 5.43304132e-01
        , 7.99591223e-01, 6.23293467e-01, -1.88025095e-01, 1.07818521e+00
        , -1.24329611e+00, 4.40903083e-01, 2.95560694e-01, -1.16212614e+00
        , 1.89934394e+00, 1.12805857e+00, -1.93124953e-01, 5.30846133e-01
        , -1.94670544e+00, -3.54843087e-01, -3.87851926e-01, 4.21770822e-01
        , -7.05337102e-01, 1.41023427e+00, -5.61747462e-01, 5.02433961e-01
        , 3.05456810e-01, -1.71164108e-02, 1.16365830e-01, -2.42179611e+00
        , 1.36552355e+00, 2.11900392e+00, 3.99605304e-01, 1.64340092e+00
        , 1.30752150e+00, 7.50049220e-01, -3.05750835e-01, -1.52613533e+00
        , -9.25042054e-01, 5.20295977e-01, 1.60305119e+00, 3.59651376e+00
        , 8.93036648e-01, 1.72403702e+00, -4.95687591e-02, 1.04833447e+00
        , -9.52917282e-01, -3.11606926e-01, -1.04580157e-01, -3.21739321e-01
        , -4.06055520e-01, -1.19496543e+00, 7.24440164e-01, 1.92186020e+00
        , -7.51112229e-01, 1.92248770e+00, 5.32318562e-01, -5.82899070e-01
        , -2.93408086e+00, 6.36984272e-01, -1.02472216e-01, 3.64944146e+00
        , 1.54049153e+00, -2.23083340e-01, 2.28092092e-01, -6.75596037e-01
        , 1.74790050e+00, 1.64191097e+00, -7.74101379e-01, 4.61707002e-01
        , -3.90607156e-01, -1.06596799e+00, -7.89922113e-01, 9.66235471e-01
        , -1.08361204e+00, 1.29023954e+00, -2.50317086e+00, -1.21915210e+00
        , -4.64633854e-01, -7.11155176e-01, -3.50221245e-01, -7.46655976e-01
        , -8.57646604e-01, 4.15225685e-01, 5.11440757e-01, -4.33441481e-01
        , 1.32612759e+00, 8.79492872e-01, -1.58150604e+00, 1.80338285e+00
        , 7.09322598e-01, 3.11169423e+00, 1.80489594e+00, -1.15300004e-01
        , -1.35042101e-01, 1.11625244e+00, -3.32641114e+00, -1.35056473e+00
        , 4.49382251e-01, -9.74218847e-01, 2.02358329e-01, 5.04877386e-01
        , -1.24199642e+00, -1.39620680e+00, 2.36906862e-02, -4.36428093e-01
        , -9.21454259e-01, -4.91157189e-01, -9.65137677e-01, 3.15868100e-01
        , 1.70793421e+00, 7.09419816e-01, -1.98976208e+00, 1.10306167e+00
        , -9.69305534e-01, 1.69191566e+00, -1.56344969e+00, -1.20627883e-02
        , 1.37300606e-01, 6.81878983e-01, -3.53555615e-01, 7.72462570e-01
        , 1.03175669e+00, 1.13782272e+00, -4.98054893e-01, 8.04164271e+00
        , -3.93761837e+00, -1.01115327e+01, 1.14357798e+01, -7.57736408e-01
        , 2.97006366e+00, -1.21047891e+01, -1.22735971e+01, 1.43681792e+00
        , 4.87301308e+00, 2.73858650e+01, -5.18393570e+00, 7.33663445e+00
        , -1.51417165e+01, 2.59119160e+00, -3.42130978e+00, -2.24638262e+00
        , -1.25591880e+01, 7.07668397e+00, -6.69910831e+01, -1.89325074e+01
        , -1.76704606e+01, 4.49393121e+00, -2.74648765e+00, 1.94325253e+00
        , -7.51488949e+00, -1.97868950e+01, 9.38562787e+00, -1.38639933e+01
        , 4.14792799e+00, -3.29246122e+01, -2.38405750e+00, -1.16797972e+01
        , -1.48440952e+01, -2.80780166e+01, -2.69956437e+01, -2.08379776e+01
        , 1.14944787e+01, -1.73376024e+01, -1.22095411e+01, -1.75724629e+01
        , -2.55030124e+00, -1.11147611e+01, -1.11758650e+01, -1.67552180e+01
        , 1.13752794e+01, -1.94877697e+01, 1.06471169e+01, -1.39685444e+01
        , -8.15792154e+00, 1.04087460e+00, -4.49660776e-01, 6.01471217e+00
        , -3.13292920e-02, -2.15054759e+00, -2.44993713e+00, 1.03178232e+00
        , 3.40467273e+01, -1.07311158e+01, -4.31768934e+00, 2.42780544e+01
        , 1.63583119e+01, -1.40434351e+01, -2.59405315e-01, 7.74195446e+00
        , -2.41309902e+00, 7.53161103e+00, -1.37686497e+01, -3.77066761e+01
        , 2.84628655e+01, -1.14320155e+00, 1.63060233e+01, -8.72725658e+00
        , 2.44843874e+01, -1.15135961e+01, -1.65521222e+01, -2.07706265e+01
        , 1.74248545e+01, -3.65157133e+01, -1.51815294e+01, 2.19202846e+01
        , 2.96863096e+00, -5.38251228e+00, -1.42232974e-01, -2.50612161e+00
        , 2.18430067e+01, 1.33288879e+00, 4.03585878e+01, -1.77605735e+01
        , 2.90551823e+01, 2.82142779e+01, 2.30902449e+01, -1.11693855e+01
        , 1.85448895e+00, 1.33818626e+01, -2.08517431e-01, -1.71841736e+01
        , -2.07190467e+01, -5.26937738e+00, 2.52817095e+01, 2.07834577e+01
        , -1.06517853e+01, 1.08188839e+01, 2.90880345e+01, 1.21402205e+01
        , 5.70484197e+00, -1.32579722e+01, -2.73496830e+00, 4.44186862e+00
        , 5.47158182e+00, -1.18857156e+01, 5.34337257e+00, 9.67157315e+00
        , -1.23538557e+01, -1.62823003e+00, -1.60762902e+01, 2.90493946e+01
        , -2.37025509e+01, 2.37375074e+00, -2.96227282e+00, 5.55457696e+00
        , -1.45231525e+00, -1.38986934e+01, -1.05208670e+01, -5.74528834e+00
        , -9.90944324e+00, 2.43647271e+00, -8.53531129e+00, 3.15213641e+00
        , -1.51456334e+01, -7.72162931e+00, 8.08711278e+00, -1.67877282e+00
        , 1.15418046e+01, -2.17023896e+01, 9.10692339e+00, 3.75967681e+00
        , 4.26153925e+00, 1.85369135e+01, 1.04271669e+00, -2.60278314e+00
        , 8.38736193e+00, -2.31015145e+01, 2.20045470e+01, -1.22234699e+01
        , 1.61744065e+01, 2.91007944e+00, 9.45214934e+00, 1.31040262e+01
        , 1.47700111e+01, -3.54486430e+01, 2.73781788e+00, -8.41072436e+00
        , 1.07069998e+01, -1.52439220e+01, -1.02166987e+01, 3.02450855e-01
        , -9.76122790e+00, 1.94053977e+00, -4.60129287e+00, -1.22578892e+01
        , 7.97314336e+00, 3.24026952e+01, 4.06396900e+01, -1.81239764e+01
        , 1.57635305e+01, 2.30024588e+01, -4.17076281e+00, -3.38345898e+00
        , -2.22086159e+01, 2.19230465e+01, -5.99317992e+00, 6.37386807e-01
        , -1.19638685e+01, 1.88100767e+01, 2.49605460e+01, 2.95016246e+01
        , 2.16195909e+01, 1.11710726e+01, 1.35699213e+01, 3.51699625e+01
        , -2.92479464e+00, -2.48358233e+01, -3.60573061e+00, 3.12590445e+01
        , 1.38118915e+01, -2.79317043e+01, -4.58641447e+00, 3.37201904e+00
        , 2.31183196e+01, -3.42798099e+01, 8.66231918e+00, 1.77712030e+01
        , 2.15263310e+01, -3.03110100e+01]

    neural_network.uni_as_net(np.array(arr))

    list = []

    for i in range(len(inputs)):
        value = encoder.activate(inputs[i])[-1]
        list.append(value)

    plot_latent_space_2D(np.array(list), decoder)


if __name__ == "__main__":
    demo()
