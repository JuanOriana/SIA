from TP5.data_structs.Layer import Layer, NeuralNetwork
from TP5.perceptron_funcs.activations import *
from TP5.resources.fonts import get_parsed_fonts
from TP5.utils.plotting_scripts import plot_latent_space_2D_static, plot_latent_space_2D


def demo():
    layer1 = Layer(5, 35)
    layer2 = Layer(2, 5)
    layer3 = Layer(5, 2)
    layer4 = Layer(35, 5)

    inputs = get_parsed_fonts()

    # Combine the layers to create a neural network
    neural_network = NeuralNetwork([layer1, layer2, layer3, layer4], sigmoid_classic_activation,
                                   sigmoid_classic_activation_derivative, 0.1)
    encoder = NeuralNetwork([layer1, layer2], sigmoid_classic_activation, sigmoid_classic_activation_derivative, 0.1)
    decoder = NeuralNetwork([layer3, layer4], sigmoid_classic_activation, sigmoid_classic_activation_derivative, 0.1)


    arr = [2.06150228e+00, 2.15067408e+00, 5.19437171e+00, -3.96524475e+00
        , 1.41827162e+00, -1.68452074e+00, -1.44626284e+00, 1.42742917e+00
        , -2.04736184e-01, 9.19594562e-03, -2.53238249e+00, -4.44081620e+00
        , -9.38406589e+00, -2.15841427e+00, -3.45648740e+00, -1.13225666e+00
        , -5.50988251e+00, -7.72039996e+00, 4.89133482e+00, -4.40216182e+00
        , -1.75472222e+00, 4.14025149e+00, 7.66339374e+00, -5.65461176e+00
        , 1.31661567e+00, -4.24002911e+00, -6.55774003e+00, -9.22546127e+00
        , 3.75792619e+00, -5.35390253e+00, 2.39596811e+00, 1.65450796e+00
        , -6.61461518e+00, -4.44116808e+00, 2.56070693e+00, 1.70592741e+00
        , 2.39664438e+00, 1.30182245e+01, -6.50755687e+00, -2.57869794e-01
        , 2.87046512e+00, 1.46616714e+00, -1.63088396e+00, -2.24536771e+00
        , 3.43613272e+00, -6.76798582e+00, -3.86009379e+00, -5.20163983e+00
        , 3.91169296e+00, -2.20159135e+00, 1.72856889e+00, -2.84741507e+00
        , -8.48269976e+00, -7.04688631e-02, -3.06978299e-01, 2.94705619e+00
        , 1.40513113e+00, 2.93485766e+00, -2.56891257e+00, 1.65534286e+00
        , 2.15882052e+00, 5.23813703e+00, 3.06498758e+00, -8.95755811e+00
        , 2.40549714e+00, 4.09128248e+00, 8.19539674e+00, 1.49290352e+01
        , -1.16959449e+01, 6.81560595e+00, -3.70601787e+00, -6.15315442e+00
        , -1.32246389e+01, 6.53545162e+00, -2.61664788e+00, 3.50015771e+00
        , -5.04703887e-01, -2.25989060e+00, 1.62949874e-01, 2.51794047e-01
        , -1.53773549e+00, -5.44170106e+00, -1.07236776e+01, 6.59125303e+00
        , -4.57700186e+00, 4.47580551e+00, -1.91426752e+00, -5.29582881e+00
        , -1.79588771e+00, -2.70103042e+00, -1.24053883e+00, -6.18574263e+00
        , -8.00756517e+00, 5.89747684e+00, -2.68279318e+00, 2.25960521e+00
        , 1.21839572e+00, 1.36819432e-01, -3.95793593e+00, -7.50523695e-02
        , 3.47911570e-01, -1.77932263e+00, -9.47231507e+00, -7.67486306e-02
        , 1.08069811e+00, 2.29108187e+00, 3.46406071e+00, 7.17014185e+00
        , -4.88075321e+00, 1.94181384e+00, -5.56962886e+00, 1.50413111e+00
        , -4.72607760e+00, -4.59638126e+00, 1.58139500e+00, 3.54639320e+00
        , 3.33659726e+00, 8.80956693e+00, -4.42281644e+00, 3.85985676e+00
        , 7.33339282e+00, -2.92102249e+00, -1.10654316e+01, 5.56663511e-01
        , -1.68926319e+00, 1.12748390e+00, -3.42198232e+00, -5.69489516e+00
        , 6.60322660e-01, -2.58460846e+00, -1.78201347e-01, 1.93617273e+00
        , 2.21115471e-01, -1.58280679e+00, 2.81429832e+00, 6.44585811e-01
        , 1.82071817e+00, 1.09091989e+01, -4.75717729e+00, -8.79309721e-01
        , 4.47357615e+00, -2.49385409e-01, -3.16705688e+00, -1.47822393e+00
        , 2.42186256e+00, 2.64848956e+00, -4.98275973e+00, -7.95139190e+00
        , 1.92202659e+00, -3.72296823e+00, -4.53867867e+00, -3.20640153e-01
        , 1.60676085e+00, 5.99923214e-02, 1.48447484e-01, 5.05780071e+00
        , 4.09745845e-01, -2.83384930e-01, -5.90691525e+00, -4.84538752e-01
        , -2.99230886e+00, -5.89678767e+00, -1.37254487e+01, 8.05424816e-01
        , -5.37994125e+00, 3.09865597e+00, -3.52739809e+00, -6.02927549e+00
        , -4.34619172e-01, -3.80378882e+00, -2.96803646e+00, -1.11035109e+00
        , -3.01124117e+00, 7.95491662e-01, -3.28746487e-01, 2.05809711e+01
        , -2.65012068e-01, -1.96223729e+00, 1.59990897e+01, -1.61353529e+01
        , 5.36871502e+01, -1.19220172e+01, -4.19448594e+01, 2.28333526e+00
        , 1.85931767e+01, -2.85208060e+01, -2.10667627e+00, -1.80088647e+01
        , 1.04072337e+01, 5.59021356e+01, 2.65687486e+01, -3.71484917e+01
        , 2.23192320e+01, -2.01025133e+01, -1.69439058e+02, -5.21737937e+00
        , -1.50238574e+00, -2.71873819e+01, -3.20302952e+00, 1.05735648e+02
        , -7.06091539e+00, -4.98107633e+01, -4.92028924e+00, -1.12571129e+02
        , -1.09008983e+00, -2.62657167e+01, -1.22873151e+01, -1.37801802e+01
        , 9.33725935e-01, -5.15553498e+00, -1.12799591e+01, -1.30135391e+02
        , 1.95377863e+01, -1.05316366e+02, -9.40504693e+00, -1.01862430e+02
        , 2.90013434e+00, -9.75245152e+01, -7.69009344e+01, -1.00003412e+02
        , 6.87593885e+00, -6.70094451e-01, -1.67885963e+00, -1.27867876e+02
        , -1.50624643e+01, -5.13798603e+00, -1.04651637e+02, -3.04039890e+01
        , -7.73525291e+00, -1.23975616e+02, -1.12156955e+01, 1.61592540e+01
        , 2.30796287e+01, 8.20639802e+00, -1.42163416e+01, 3.02529415e+01
        , -3.09420659e+01, -6.84086301e+00, -1.09732102e+01, 1.49512345e+01
        , 1.19030390e+01, -8.38548060e+00, -6.15978306e+00, -9.39091140e+01
        , 1.51258597e+01, -6.52682594e+01, 1.03868798e+01, -4.20100499e+01
        , 3.30483148e+01, -7.28594889e+00, -6.99000277e+01, -2.13855476e+01
        , -4.39428646e+00, -1.16103198e+01, -6.23469058e+01, -1.76937932e+01
        , -2.98953013e+00, -8.68030889e+00, 4.60582619e+01, 4.52775546e+00
        , -7.28885933e+00, 1.33790343e+01, 2.14166088e+01, 5.99017348e+00
        , -4.83411748e+00, -2.89677636e+01, 1.18353211e+00, -1.57596795e+00
        , 2.28692551e+00, -5.01302611e+01, -6.62492158e+01, 6.41717283e+00
        , 1.68145446e+00, 2.12607072e+01, -3.99485277e+01, -7.76978835e+01
        , 3.26549971e+00, 4.51922918e-01, 5.10009374e-01, -3.79205389e+01
        , -6.18338681e+01, 1.68563151e+01, -8.10489067e+00, 2.45834275e+01
        , -7.93767021e+01, 1.82430307e+01, 5.28252711e-01, 1.74769782e+01
        , 1.79128066e+01, 1.83190436e+01, -4.18151186e+00, 1.03394335e-01
        , -1.15234969e-01, 2.41540668e+01, -6.14144352e+01, -2.75114211e+01
        , 2.48196334e+01, -2.81258215e-01, 2.56755469e+00, 1.18007042e+01
        , -3.53955980e+01, 6.72436411e+00, 7.94368600e+01, -3.02540848e+01
        , 8.27474213e+00, -9.06182816e+00, 6.49939349e+01, 1.07076130e+01
        , -3.25957213e+01, -1.95009797e+01, -5.78702075e+00, 4.41699608e+00
        , 7.29064271e+00, -1.67226568e+00, -1.99712568e+01, -1.28969961e+01
        , -2.48385059e+01, -9.01927679e+00, -4.32854831e+01, 1.00791469e+01
        , -2.85588279e+01, -1.04485087e+02, 1.55267451e+01, -1.96936459e+02
        , -1.96003436e+01, 1.01329025e+00, -7.26380664e+01, 1.16138126e+01
        , -4.41996267e+01, -2.82155775e-01, -3.47753202e+01, 3.35481322e+01
        , 9.82926559e+01, 1.36404041e+01, -3.27251326e+01, -1.30734405e+01
        , -1.02762489e+01, 2.76619197e+01, 1.64659402e+02, -2.37938607e+01
        , 6.00686146e+01, -5.44893123e+01, -7.12389213e+01, -1.30001289e+01
        , 5.18907135e+01, 4.98911292e+01, -1.46772349e+01, -2.55549631e+01
        , 1.31836096e+01, 5.30208119e+01, 3.59067678e+01, 3.53113162e+01
        , 3.34115435e+01, 5.79071763e+01, -1.21833425e+01, 7.13517308e+01
        , -2.54514534e+01, -9.34245112e+01, -1.25342610e+01, 1.16364880e+02
        , 1.18313408e+01, -1.18598823e+00, -7.57410296e+01, 1.95122293e+01
        , 2.40403826e+01, -7.71049939e+00, 1.52290801e+01, 2.70034599e+01
        , -1.11353308e+01, -6.88288972e+00]
    neural_network.uni_as_net(np.array(arr))

    list = []


    for i in range(len(inputs)):
        value = encoder.activate(inputs[i])[-1]
        list.append(value)

    plot_latent_space_2D(np.array(list),decoder)

if __name__ == "__main__":
    demo()